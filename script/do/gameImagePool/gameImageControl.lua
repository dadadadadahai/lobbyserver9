module('gameImagePool',package.seeall)
local table_autoControl_dc = import 'table/table_autoControl_dc'
local table_parameter_parameter = import 'table/table_parameter_parameter'
local table_auto_betUp = import 'table/table_auto_betUp'
--图库数据
--[[
    [gameId]={
        [type] = [mul] = info
    }
]]
math.randomseed(tonumber(tostring(os.time()):reverse():sub(1, 9)))
local poolMap={}
function loadPool(gameId)
    go.ImagePools.LoadImagePool(gameId,unilight.get_mongodb())
end

--[[
    gameObj 游戏模块
    param {betchip 押注值
    }
]]
local index1 = 0
local index2 = 0
local index3 = 0
local rmdayu0  = 0
local rmdayu1  = 0
function RealCommonRotate(_id,gameId,gameType,imageType,gameObj,param)
    local betchip = param.betchip
    local demo = param.demo
    local userinfo = unilight.getdata('userinfo',_id)
    local totalRechargeChips = userinfo.property.totalRechargeChips
    userinfo.point.chargeMax = 100000000
    userinfo.point.maxMul = 40000
    local controlvalue = gamecommon.GetControlPoint(_id,param)
    -- --获取rtp
   local rtp = gamecommon.GetModelRtp(_id, gameId, gameType, controlvalue)
   if not demo  then 
        local betIndex = param.betIndex
        local betrtptable = gameObj['table_'..gameId..'_betrtp']
        rtp =  betrtptable[gamecommon.CommRandInt(betrtptable,'bet'..betIndex)].bet_level
        unilight.info('@@@@betrtptablertp', rtp) 
        --local rtptable = gameObj['table_'..gameId..'_rtpswitch']
       -- local rtp = 200 --没充值的直接走200
       -- if totalRechargeChips >0 then 
       --  rtp =  rtptable[gamecommon.CommRandInt(rtptable,'pro')].type
        --end 
   else
        rtp = 200 
   end
    local imagePro = string.format("table_%d_imagePro",gameId)
    if imageType==nil then
        imageType = gameObj[imagePro][gamecommon.CommRandInt(gameObj[imagePro],'gailv'..rtp)].type
        -- local sfree = gameObj.gmInfo.sfree
        -- if sfree>0 then
        --     imageType = sfree
        -- end
    end

    --就计算玩家当前允许的最大倍数 改变了userinfo.point.maxMul的值
    -- getPlayerMaxMul(userinfo,betchip,totalRechargeChips,gameType,gameObj)
    --开始拼装配置表
    local tmpPoolConfig = {}
    local tableconfig = string.format('table_%d_rtp',gameId)
    local mulField =  string.format('type%d_%d',imageType,rtp)
    local gailvFiel = string.format('type%d_gailv%d',imageType,rtp)
    local tableOjconfig = gameObj[tableconfig]
    for _, value in ipairs(tableOjconfig) do
        if value[mulField]<=userinfo.point.maxMul and value[mulField]>=0 then
            table.insert(tmpPoolConfig,{
                mul = value[mulField],
                gailv = value[gailvFiel]
            })
        end
    end
    --执行随机    

    unilight.info('userinfo.point.maxMul',userinfo.point.maxMul,tableconfig,imageType,rtp,mulField,gailvFiel,#tmpPoolConfig)
    local realMul = 0
    if #tmpPoolConfig>0 then
        realMul=tmpPoolConfig[gamecommon.CommRandInt(tmpPoolConfig,'gailv')].mul
    else
        imageType=1
    end
    if gameId == 164    then 
        if imageType == 1 then 
            local curealmul = {0,0,0,0,3,0,0,0,0,0,0,0,0,0,1,0,1,0,0,5,0,0,0,0,0,0,1,1,0,0,0,1,0,1,1,2,1,3,1,0,1,0,0,0,0,1,1,1,0,2,0,1,0,0,0,3,0,0,0,0,1,0,3,0,0,1,0,0,0,0,0,0,0,0,4,0,1,5,1,0,0,0,1,0,0,0,0,1,0,1,1,0,0,1,0,1,0,0,0,1,2,2,1,0,5,0,2,0,1,1,1,0,0,1,0,0,3,2,0,0,0,1,0,2,0,0,3,2,1,0,1,1,0,1,0,0,2,1,1,1,0,2,0,3,0,0,1,0,1,0,3,0,1,0,0,5,0,0,0,1,3,3,1,0,0,3,0,0,0,3,0,0,0,3,0,0,4,3,0,3,1,8,0,2,0,0,3,1,0,2,0,0,0,0,0,0,0,0,0,0,0,3,0,1,1,0,1,1,4,1,4,0,0,2,4,1,0,0,0,0,0,1,0,2,1,1,0,1,0,0,5,0,2,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,8,1,2,1,3,1,0,4,0,0,0,1,0,3,0,0,1,3,3,0,1,0,0,3,0,0,5,1,1,0,0,0,0,0,1,0,5,0,0,0,0,3,1,10,0,1,0,0,0,0,2,2,0,2,0,1,3,3,1,0,3,2,0,1,0,0,2,1,0,0,0,3,0,0,3,0,3,3,3,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,3,0,1,1,0,1,1,3,0,1,0,0,1,1,2,0,1,1,0,0,0,0,0,1,2,0,0,2,3,15,1,3,0,3,4,0,0,2,1,0,1,1,5,1,0,0,2,0,0,1,0,0,0,0,0,1,3,0,1,0,0,2,0,0,0,0,2,1,5,0,0,2,0,1,0,1,0,1,0,0,0,0,0,5,1,0,0,1,3,0,1,0,0,1,0,1,2,2,1,0,0,0,0,0,0,0,0,2,0,0,0,0,0,1,0,0,2,0,0,3,0,0,3,1,1,0,0,2,0,1,0,0,0,3,0,1,1,0,1,1,0,0,0,1,2,0,1,1,0,0,0,3,2,2,0,0,0,0,0,1,0,1,0,1,1,3,1,2,0,0,2,0,1,2,0,2,0,0,0,0,0,4,8,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,0,0,1,0,3,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1,0,2,1,1,3,1,0,0,0,5,0,0,2,1,0,0,0,1,0,0,0,1,1,0,3,1,0,1,0,0,1,1,0,1,2,0,1,8,1,2,0,0,0,0,0,1,1,3,0,1,0,1,1,0,0,1,0,3,0,0,0,0,0,0,0,1,0,0,1,10,1,1,3,0,0,0,0,2,0,0,0,3,0,0,1,0,2,0,2,1,1,0,0,0,0,5,0,2,1,0,1,0,0,0,0,0,1,0,0,0,3,0,5,0,1,0,0,0,0,5,1,0,1,0,0,1,2,0,0,2,0,0,1,0,0,0,0,1,3,0,0,1,1,0,3,5,2,0,0,0,1,3,0,0,1,1,0,1,2,8,1,1,0,1,0,0,8,2,0,1,0,0,3,1,0,3,0,0,2,0,0,1,8,1,1,0,1,1,0,0,0,1,0,0,5,2,0,0,3,1,3,5,1,0,0,0,5,0,1,0,0,2,2,2,3,0,1,0,0,0,0,1,0,8,1,0,0,2,0,1,0,1,0,0,1,0,2,0,3,0,5,1,0,0,0,3,0,0,5,1,1,5,1,0,0,0,0,0,0,0,1,0,0,0,2,5,0,0,1,0,2,0,1,0,1,0,0,0,0,1,0,0,1,3,1,1,1,2,0,0,1,8,0,0,1,0,0,1,1,0,1,1,0,0,0,1,3,0,1,0,0,0,0,0,0,0,1,2,0,0,0,1,0,0,0,3,0,0,1,1,3,1,0,0,1,1,1,1,0,2,1,0,0,1,0,0,2,0,0,0,3,3,1,0,0,0,0,1,0,5,2,0,0,0,1,1,0,0,1,0,0,3,1,3,1,1,1,0,3,1,0,1,0,1,0,0,0,1,0,1,0,0,3,0,0,0,0,1,2,3,3,1,3,1,2,0,1,3,0,10,2,1,2,3,1,0,0,2,4,0,1,3,0,0,0,1,1,0,0,0,0,0,3,0,0,0} 
             realMul =curealmul[math.random(#curealmul)]
         end 
         if imageType == 2 then 
             local curealmul = {18,6,25,2,4,10,80,2,2,2,4,10,2,6,6,6,4,15,25,15,9,3,4,3,4,16,6,6,6,20,6,3,9,3,2,32,4,10,6,10,75,6,15,10,9,3,2,15,6,2,2,4,6,8,4,9,2,16,10,20,4,2,3,15,8,6,30,4,2,15,6,12,6,30,3,2,3,50,2,6,3,3,6,4,2,2,10,30,9,25,4,2,4,6,9,6,4,3,3,45,3,9,15,25,20,3,2,6,9,6,4,25,60,15,3,3,40,4,50,6,6,4,2,2,6,24,6,4,30,10,3,16,6,3,6,50,9,9,6,6,3,16,2,2,15,9,6,4,4,30,10,800,2,2,4,2,2,10,10,2,2,9,2,30,10,6,2,2,6,4,15,4,6,4,3,10,2,10,2,2,6,3,20,2,8,16,2,24,20,10,2,9,15,6,2,5,15,2,2,3,6,9,6,6,4,30,4,6,9,2,2,12,6,3,6,2,3,6,10,10,6,2,9,2,30,6,6,4,9,10,6,9,20,2,250,12,2,45,20,8,4,30,2,6,22,2,9,3,8,6,3,12,6,2,3,6,15,5,2,4,2,2,2,20,20,6,10,4,12,2,3,6,2,22,5,2,2,6,10,2,3,6,10,9,2,45,6,3,2,4,9,2,10,12,36,50,4,50,8,9,150,12,10,9,6,12,2,6,4,4,4,10,4,2,5,2,3,2,4,4,2,4,4,2,6,2,6,30,6,6,25,6,3,100,3,10,4,6,4,30,6,3,2,6,6,25,3,3,3,4,9,4,2,15,6,10,6,15,2,30,6,4,6,6,10,30,6,6,4,6,8,8,6,6,2,10,18,2,12,3,15,6,2,6,25,16,2,2,10,2,8,4,9,2,6,4,8,15,10,6,10,3,5,15,12,6,18,16,4,2,6,10,9,6,16,2,50,2,25,6,3,50,9,2,50,6,9,6,6,15,6,10,2,10,400,8,4,2,20,4,10,16,2,6,9,12,10,4,2,3,30,4,18,6,6,45,9,6,2,10,15,6,15,4,16,10,12,3,9,3,2,10,6,3,2,3,25,14,5,10,6,6,50,4,3,21,9,15,40,15,6,2,3,10,80,6,6,4,22,6,6,6,12,15,6,25,8,2,10,15,9,20,2,500,15,30,24,9,8,6,10,2,6,2,16,9,4,10,15,8,8,10,10,4,3,2,20,2,12,20,3,2,30,50,3,12,8,4,21,6,2,15,6,6,2,2,4,2,3,2,25,24,6,3,9,10,3,10,2,6,2,6,15,20,35,6,8,2,3,2,6,6,9,6,2,4,6,10,2,30,6,3,6,4,6,2,2,4,50,10,14,2,3,5,2,6,6,9,8,30,6,3,5,2,6,6,6,30,2,10,3,2,50,9,15,2,9,6,3,4,30,8,2,2,6,16,6,6,4,22,2,2,8,25,6,2,5,3,3,10,10,2,6,12,10,6,6,2,4,2,4,9,2,2,2,6,9,2,6,12,30,8,2,2,12,2,2,3,30,8,10,6,9,2,9,3,16,2,2,9,20,16,6,10,12,40,10,16,36,100,6,2,8,12,30,6,3,5,2,15,5,2,6,8,6,6,3,15,6,3,2,3,10,9,4,30,3,6,6,6,24,20,12,2,12,12,9,45,15,6,30,10,2,8,9,4,2,2,3,2,3,16,4,2,2,2,10,6,15,2,15,2,2,6,8,3,100,6,4,8,3,42,4,2,3,6,6,2,3,10,9,3,15,10,15,4,24,45,20,10,12,16,30,30,6,6,3,2,20,6,9,9,10,100,3,8,4,10,4,10,6,4,5,6,2,8,2,2,4,10,3,10,8,6,2,3,50,3,2,15,3,6,150,9,4,4,9,2,6,10,2,16,10,12,2,30,6,3,2,6,6,15,12,6,6,2,4,16,4,4,2,21,2,2,6,15,2,3,5,6,3,4,4,10,3,40,30,10,10,6,20,1000,6,2,2,3,6,4,2,30,6,20,6,6,2,3,6,6,20,3,2,16,6,33,6,20,3,2,3,2,500,8,36,2,2,250,9,25,16,3,60,2,2,15,4,6,6,2,2,6,3,16,12,2,4,6,3,30,15,50,4,150,3,6,2,4,6,16,9,15,2,4,4,3,12,6,15,4,15,6,3,2,9,6,2,30,10,6,3,6,9,10,6,6,10,2,2,6,3,9,2,2,2,2,10,150,50,6,14,12,2,20,10,21,12,2,8,15,4,2} 
            realMul =curealmul[math.random(#curealmul)]
         end 
    end 
    if gameId == 163    then 
        if imageType == 1 then 
           local curealmul = {5,5,20,0,0,5,55,5,0,0,0,5,45,0,10,5,0,10,0,0,55,10,0,5,30,10,25,0,0,0,0,0,0,0,0,10,0,15,0,0,0,0,0,45,5,15,0,0,0,20,0,5,15,0,5,0,0,0,10,0,5,5,25,10,0,0,5,15,5,40,10,0,30,0,55,0,0,5,0,40,0,10,0,0,10,25,5,5,0,0,0,0,0,0,0,0,0,0,75,0,5,0,0,15,0,5,10,5,5,0,10,10,0,0,5,0,10,0,15,0,20,0,10,0,0,5,0,0,0,0,0,0,5,10,0,0,0,5,40,0,15,0,40,0,40,40,0,0,5,0,0,0,0,0,10,5,0,10,10,10,0,45,5,0,0,0,5,0,25,0,10,5,0,5,10,0,45,0,0,20,0,0,0,5,10,10,0,15,0,10,0,5,0,0,0,0,50,0,5,15,0,0,0,5,0,0,0,0,0,5,0,0,10,0,0,5,5,5,0,20,0,20,10,10,90,10,0,0,0,5,10,0,0,15,0,10,20,0,5,0,0,5,90,15,0,5,0,15,0,5,0,30,0,0,0,0,10,0,20,0,0,0,0,0,0,10,5,5,0,0,0,0,5,10,0,0,0,10,10,20,0,30,5,0,10,60,0,0,0,0,0,10,0,0,10,0,0,10,15,0,45,0,0,0,40,0,0,10,10,10,0,30,10,5,0,10,0,45,0,0,0,0,10,45,0,5,10,0,0,30,0,5,0,5,0,10,0,20,0,0,20,0,5,35,5,5,0,0,0,5,15,0,0,0,15,0,15,0,10,10,90,0,0,0,0,0,55,5,0,5,0,5,5,0,100,0,0,0,0,15,10,0,0,5,5,0,15,0,15,20,0,5,0,5,10,10,25,0,0,15,0,0,10,5,0,0,0,0,5,50,0,10,25,5,5,0,5,15,20,0,0,0,5,0,10,0,5,0,0,15,5,10,0,0,15,0,10,0,0,0,0,5,0,10,10,45,0,10,5,5,0,10,0,20,0,10,0,70,0,0,5,0,5,0,20,0,0,50,0,0,40,0,0,0,10,0,0,0,0,0,0,15,0,0,75,0,15,0,0,10,0,0,5,10,5,30,5,15,10,5,0,5,0,5,20,5,0,0,0,40,0,5,10,5,10,5,10,0,0,0,0,15,10,0,0,0,10,0,0,0,0,10,0,0,10,0,0,0,5,0,0,5,100,10,0,10,0,0,10,0,10,0,5,0,0,10,0,0,10,5,5,10,15,0,5,0,5,0,10,25,25,0,0,0,5,0,5,0,5,0,0,20,0,15,30,0,10,0,5,20,80,0,0,0,5,0,0,5,0,0,0,30,15,0,20,5,0,15,0,0,25,0,5,10,20,65,10,0,5,5,0,10,15,5,0,20,5,10,0,5,0,0,10,0,10,0,0,15,0,30,0,10,0,0,40,10,0,30,0,0,0,5,20,5,10,0,0,20,0,50,5,0,0,0,0,5,0,0,0,15,0,0,0,0,0,0,0,0,5,10,0,0,0,10,5,0,0,0,0,20,0,0,40,0,0,0,0,0,0,0,5,0,5,10,0,0,5,0,10,0,0,0,0,5,0,15,5,10,25,5,0,5,10,0,5,0,5,5,5,35,0,40,0,0,5,0,10,10,0,0,40,15,0,0,0,0,10,0,0,0,10,0,10,5,5,15,0,80,0,5,0,5,5,10,5,0,0,20,0,10,0,0,5,10,0,0,0,115,0,0,0,0,5,0,0,0,0,0,0,20,10,0,0,10,0,0,10,5,0,0,5,0,50,0,5,0,10,0,15,20,0,0,0,5,10,5,10,0,5,0,45,0,0,50,5,0,30,0,5,0,20,5,145,15,0,5,30,30,5,10,10,15,15,0,0,5,0,50,0,0,40,0,20,5,0,5,40,0,5,5,10,10,0,10,0,10,15,0,0,10,0,0,5,0,0,5,0,0,5,5,0,0,15,45,0,0,0,0,0,35,10,0,10,5,10,40,0,0,15,5,10,5,0,0,0,5,0,10,0,5,10,0,10,0,0,5,20,0,90,0,5,10,15,0,0,20,10,10,0,30,30,0,0,5,0,0,0,0,0,5,10,0,30,0,0,10,10,5,10,0,5,0,5,5,50,0,0,5,0,0,5,0,0,10,10,0,0,0,0,10,15,0,10,0,0,40,10,15,0,0,5,0,5,40,10,0,10,55,5,0,5,0,0,5,5,10,0,10,5,0}
            realMul =curealmul[math.random(#curealmul)]
        end 
        if imageType == 2 then 
            local curealmul = {80,205,260,310,175,65,350,270,20,35,155,15,30,50,180,180,520,220,30,15,65,475,230,40,25,50,25,505,705,490,0,45,110,35,650,220,200,20,40,20,620,25,25,35,45,170,30,135,165,175,70,25,45,65,175,185,615,195,35,25,165,615,170,55,35,165,225,85,180,35,10,510,30,30,495,30,25,205,45,25,70,290,145,25,20,75,90,20,680,135,25,170,30,5,115,50,685,370,210,65,230,95,70,40,165,55,55,100,540,10,15,465,195,35,225,220,305,245,85,455,120,1700,20,565,35,255,20,45,190,35,55,20,930,110,15,300,20,20,85,70,50,155,10,125,130,490,185,35,645,380,450,225,90,35,260,645,360,365,250,830,650,195,215,800,535,200,20,30,5,35,175,200,80,20,55,55,30,570,100,20,80,25,170,25,190,25,15,40,40,55,20,475,45,45,20,195,45,25,205,40,780,110,215,20,45,60,45,170,215,10,75,5,120,15,220,35,195,15,105,65,115,125,20,45,0,30,55,125,65,30,215,415,35,765,60,185,665,35,55,10,45,35,25,265,45,55,20,100,45,55,155,270,95,340,195,195,65,40,490,205,200,160,20,110,15,155,330,255,200,35,215,185,115,190,80,180,380,225,690,260,20,325,195,480,20,155,75,255,25,20,50,190,65,30,210,105,410,65,220,35,10,220,435,510,40,95,465,35,30,205,50,50,80,165,10,630,15,230,35,60,40,15,115,15,680,250,235,35,30,220,50,135,90,390,25,45,75,240,175,15,185,45,15,40,90,50,110,245,30,45,235,175,155,235,65,5,30,20,150,50,55,25,175,200,30,100,125,15,60,100,5,15,40,45,5,25,185,330,25,30,330,30,150,85,215,5,485,10,35,145,1545,265,75,160,75,60,15,100,225,60,20,45,60,175,230,235,50,25,60,235,195,45,25,45,130,40,90,190,10,20,190,75,85,165,35,40,325,180,25,55,155,470,100,45,45,30,30,550,35,30,20,165,60,130,235,155,10,180,665,20,20,650,420,205,30,95,70,160,260,50,250,35,75,460,390,195,30,20,50,20,195,15,205,225,105,135,40,165,60,680,15,35,50,65,60,105,15,40,45,55,10,175,295,695,485,190,225,195,25,35,160,30,80,75,55,40,15,35,105,460,65,55,40,185,105,150,325,45,65,540,205,85,35,60,215,20,355,340,240,200,20,335,185,620,20,225,465,690,65,225,125,485,375,160,25,50,615,325,75,185,545,30,40,25,90,25,45,20,160,10,170,35,330,185,25,80,300,190,50,200,70,70,35,0,35,15,45,50,10,85,1535,175,20,70,165,515,45,345,290,25,170,50,35,25,230,30,85,30,80,200,40,40,45,35,150,55,25,25,35,55,85,60,50,15,175,15,85,55,175,40,20,355,15,85,100,65,25,325,95,10,45,550,20,25,30,40,220,230,20,10,350,90,120,1680,30,50,50,205,25,70,85,485,200,195,200,225,80,90,100,5,65,20,15,165,30,20,75,50,25,185,40,40,40,55,40,105,15,170,215,55,525,350,220,175,115,1670,60,5,170,160,185,40,195,35,70,45,10,85,35,15,35,30,175,255,40,20,20,40,20,150,25,85,35,5,50,50,170,475,520,25,0,170,15,50,300,465,160,40,380,155,40,95,50,175,30,120,80,115,50,10,55,15,190,55,215,40,155,385,285,205,185,230,35,40,1015,495,25,80,35,645,80,35,60,200,65,65,220,85,70,30,55,65,5,35,55,25,10,215,30,20,195,480,230,195,175,170,255,55,15,1520,140,220,20,50,335,70,25,20,700,35,235,95,15,75,100,90,20,25,175,15,170,350,30,55,95,25,110,0,185,50,165,25,45,90,5,200,205,235,125,155,40,15,150,200,115,35,1250,45,415,30,10,165,50,805,35,385,30,45,215,30,340,30,120,490,220,50,60,160,195,50,35,80,50,475,185,5,30,100,110,195,10,25,20,40,475,30,40,10,30,190,200,45,20,25,25,40,65,130,95,35,50,30,15,115,5,180,90,215,175,30,45,40,340,240,160,500,100,5,50,65,515,40,65,55,20,50,175,70,40,20,65,55,75,65,55,50,500,10,100,35,100,170,50,490,20,520,20,30,175,60,225,375,20,90,65,50,40,25,35,20,505,350,465,90,235,35,160,60,470,50,205,165,185,205,215,480,155,115,100,40,25,70,1685,75,20,270,70,175,60,195,40,25,50,20,55,60,40,50,135,50,30,60,1505,205,325,25,20,215,20,25} 
                      realMul =curealmul[math.random(#curealmul)]
        end 
        if imageType == 3 then 
           local curealmul = {150,150,170,155,150,450,155,160,450,450,160,150,150,470,170,150,150,150,150,1505,155,170,150,150,150,450,150,150,150,170,150,150,150,450,175,150,150,160,450,150,160,150,450,150,150,150,150,150,150,150,150,150,450,150,150,150,150,160,150,470,150,155,150,150,455,150,150,470,450,150,160,150,150,150,150,155,150,450,150,150,150,155,150,150,155,495,150,155,450,150,160,155,150,450,150,150,450,150,150,480,470,150,150,150,150,150,450,155,460,150,150,170,450,155,150,465,150,150,1500,150,450,150,150,450,150,155,150,155,160,150,150,150,155,150,460,150,165,150,150,150,160,150,155,155,150,150,150,150,455,150,175,150,150,150,150,150,150,455,150,150,450,450,160,150,150,160,150,150,450,150,450,150,190,150,150,150,150,455,150,450,150,150,190,450,150,150,165,150,150,150,150,450,150,160,150,155,160,455,160,185,450,165,450,155,150,150,155,150,155,150,150,160,150,150,150,455,150,150,155,155,450,175,150,450,150,150,150,190,455,150,150,1500,160,460,160,150,155,150,150,155,150,155,150,150,150,450,150,150,175,155,180,165,175,150,150,150,1500,150,150,150,165,150,150,155,150,150,150,460,450,150,180,455,450,455,450,150,150,150,150,150,460,150,150,150,150,160,160,150,195,150,155,150,170,160,450,150,150,150,450,170,450,150,460,155,150,150,150,150,190,150,150,150,150,150,150,150,150,150,155,450,450,160,150,160,150,150,150,150,150,450,450,150,150,150,155,150,465,150,150,150,450,160,450,180,450,150,160,150,150,460,155,150,160,450,160,150,160,150,190,505,150,450,160,150,150,150,450,155,165,150,150,685,450,450,150,160,155,155,155,155,155,450,150,160,150,470,150,455,160,150,150,150,450,150,150,450,160,455,450,150,150,450,155,150,155,150,165,160,160,475,150,150,150,150,150,150,450,160,460,150,150,150,160,155,170,150,165,210,165,460,150,450,155,150,150,150,150,185,150,150,150,150,150,160,150,150,460,150,150,155,150,150,160,450,460,150,150,460,150,155,160,155,155,160,150,150,150,150,450,450,150,150,150,450,150,160,150,150,450,150,150,455,1500,150,155,150,150,155,150,160,160,150,150,150,165,150,150,155,150,150,150,165,150,155,450,450,150,150,450,165,160,170,155,150,150,155,160,150,150,190,150,150,160,160,150,155,160,155,150,155,470,155,155,150,150,150,150,155,150,150,450,460,150,155,150,155,450,160,150,150,150,150,160,460,150,155,150,480,175,150,160,460,150,155,150,460,455,450,155,150,455,150,155,150,160,170,465,150,155,150,150,160,160,160,150,150,150,165,450,165,450,480,160,155,170,160,155,160,155,150,155,150,150,150,155,150,165,150,160,150,155,155,150,150,170,150,150,150,450,450,150,160,150,150,150,170,155,150,450,150,150,150,150,150,150,150,160,150,155,150,150,150,150,155,150,465,150,150,160,150,155,150,155,150,150,150,170,160,150,155,155,155,150,155,150,150,450,150,195,150,450,150,150,155,150,1505,160,150,150,1500,450,150,150,150,150,460,450,150,155,160,150,150,155,160,450,160,150,460,150,450,150,150,160,150,170,150,150,170,150,460,155,150,155,450,150,150,150,150,155,455,150,150,200,450,460,150,150,150,160,150,460,150,450,450,155,155,150,450,450,150,165,155,150,150,150,450,460,150,150,150,150,150,460,500,150,150,150,180,160,450,150,155,150,150,150,155,150,150,455,150,160,160,150,190,450,170,150,150,450,1500,150,160,150,160,150,165,150,155,150,170,150,150,150,150,150,150,1500,450,460,160,150,450,195,150,450,470,150,150,155,155,150,450,150,150,150,160,150,160,150,165,150,150,160,450,150,150,160,150,165,150,155,465,150,150,150,150,150,160,150,150,155,160,150,150,150,155,160,450,150,450,460,460,150,170,150,160,150,160,150,150,150,150,155,150,150,150,150,150,150,150,150,450,150,195,150,150,150,150,150,155,155,160,150,150,155,450,150,455,150,195,150,150,150,150,150,150,150,450,150,160,150,150,465,150,450,150,460,150,460,150,150,150,160,150,155,150,150,150,150,160,155,150,150,150,1500,150,150,160,150,150,150,150,150,160,150,150,155,150,150,155,160,155,160,160,150,150,155,155,150,150,450,150,465,160,150,150,150,455,150,160,150,150,150,450,450,150,150,150,185,150,450,150,155,225,465,160,465,150,150,155,150,150,150,150,455,150,150,150,150,150,150,450,160,150,150,160,160,150,150,160}
               realMul =curealmul[math.random(#curealmul)]
        end 
    end
    if gameId == 126    then 
        local curealmul = {0,0,0,0,0,0,0.6,0,0.2,0,0,0,0,0.4,0.2,0,0,0,0,0.4,0,1,0,0,0.2,0,0,0,0.2,0.2,0.2,0,0.2,1.2,0,0,0,3,0,0,0,0,0,0,0,0,0,0.2,0,0,0.5,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0,0,0,0,0,0,0,0.8,0,0.4,0,0.2,0,0,0,0,0.2,0,0,0,1,0,1,0,0.4,0.2,0,0.4,0,0.2,0,0,0,0.4,0,0,0,0,0,0,0,1.2,0.2,0,0,1.5,0,0,0.4,0.2,0,5,0,0,0,0.2,0.2,0.2,1.2,0,0,0,0,0,0,0,0.4,0,0,0,0,0,0,0,0,0.4,0.2,0,0.2,0,0,0.2,0,0,0,0,1.4,2.4,0,0.2,0,0.4,0,1.4,0.2,0,0.2,0.2,0,0,0,0,0.2,2.5,0.4,0,1,0,0.2,0,0,0,0,0,0.6,0,0.2,0,0,0.8,0,0,0,0,0.2,0,0.2,0,0.2,1,0,0,0,0,2,0.4,0,2.2,0,1.2,0,0,0,0,0.2,0,0.6,0,0,0,0,0.2,0,0,1,0.6,0,1,0.2,0,0,0.2,0,0,0,0,0,0,0.2,0,0.2,0,0,0.5,0,0,0.2,0.2,0,0.8,0,0,0,0,1,0,0.2,0.2,0,0,5.2,0,0,0.2,0,0.4,1,0.4,2.5,0,1,0,0,0.2,0,0.2,0,5,0,0,0,1,0,0,0.2,0,0,1,0.2,0,0,0,0,0.4,10,0,0,0,0,0,0,0,0,0,0.2,0.4,0,0,0,0,0,0,0,0.2,0,0,0,0,0.6,0,0,0.2,0,1,0,0,0,0,0,0,0,0.2,0,0,0,0,0.4,0,0,0,0.4,0,0,0,0.4,0,0.2,0,0,0,0.4,0,0,0,1.2,2,0,0,0,1,0,0.4,1.4,0.2,0.5,1,0,0.2,0,0,0,0,0,0,0,0,0,0.2,0,0,0.2,0,0,0,0,0,0,0,0,0,1.2,0.2,0,1.2,0,0,0,0.4,0.2,0.5,0,0.2,0,0,0,0,0,0,0,0,1.2,0.2,0,0,0,0,0,0.2,0,0,0.4,0,0,0,10.2,0,0,2,0,0,0,0,0.2,1,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0.2,0,0,0,0.4,0.2,0,0,0,0.2,0,0,0.2,0,0,0.2,1,0,0,1,0,1.2,0,0.2,0.2,0,0.2,0,0,0,0,0,0,0.4,0,0,0,0,0,0,0,0,0.2,0.2,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0.2,0,0,0,0.2,0,0,0.2,0,1,0,0,0,0,0,0,0,0,0,0,0,0.2,0.5,0.2,0,1,0.2,2.2,0,0,0,0,0,0,5,0,2,0,0,0,0,0,0.2,0.2,0,0,0.2,0,0.2,0,0,0,0.2,0.2,0,0,1,0.2,2,0,0,0,0,0,0,5,5.2,0,0,0,0,1.2,0,0,0,0,0,0,0,0,0.2,0,0,0,0,0,0.2,0,0,0,2.9,2.2,0.2,0,0,1,0.2,1.2,0,0,1,0.6,0.2,0,0,2,0,0,0,0,0,0.2,0,1.2,0,0.5,0,0,0.2,0,0.4,0,0,0,0.2,0,0.2,0,11,1.2,0,0,0,0.4,0,2,0,0,3.2,0,0.6,0,0,0,0,0,1,0,0,0,1,2.2,0,0,0,0,0,0,0,0,0,0,0,4.5,0,0,0,0.2,0,0,0,0,0.2,0,0,0.2,0,0,0.2,0,0.4,0,0.2,0.7,0,0,0,0,0.2,0,0,0,0,0,0,0,0.4,0,0,0.2,0,0,0,2.7,2.7,0,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.4,0,0,0,0,0,0,0.2,0,0,0,0,0.2,0.2,0,0,0.2,0,0,0,0,0.2,0,0.4,0,0.2,0,0,0,0,0.2,0,0,0,0,0.2,0,0,0,2,0,0,0,0.2,0,5.4,0.2,0,0,5,0.2,0,0,0,0,0,0,0,0,0.2,0,0,0.2,0.2,0.4,0.2,1,0,2,0.4,0,0,0,0,0,0,0,0.2,0,3,0.2,0,0.2,0,0,0,2,0.4,0.4,0,0,0,0,1,0,0,0,0,0.4,0.2,0,0,0.2,0.2,0,0.2,0,0,0,2,0,0.2,0,0,0,0,0,0,0,0,0.2,0,0.2,0,1.2,0,0,2,1,0,0,0,0.4,6.2,0.2,0,0,0,0,0.2,0,0,0,0,0,0,0.2,0,0.4,0,0,0.2,2.4,0,0,0,0,0,0.2,0,0,0,2.5,0,3.2,0,0,0,0,0,0,0.2,0,0,0,0,0,0,0.4,0,0,0.2,0,0,0,0,0.4,0,0.2,0,0,1,0.2,0,0.2,0,1.4,0,0,0,0,1,0.2,10.4,0,0.2,0.2,0,0.2,0,0,0.2,0,0,0,0,0,0.2,0,5,0,0,0.6,0,0,0,0.2,0,0,0,0,0.2,0,0,6.2,0,0.2,0,0,0,0.2,0.2,1,0,0.2,0,0,0,0}
          realMul =curealmul[math.random(#curealmul)]
    end 
    unilight.info('gameId.imageType.realMul',gameId,imageType,realMul)
    

    local jsonstr=go.ImagePools.GetOnePool(gameId,imageType,realMul)
    if jsonstr=='' then
        unilight.info('norealmul imageType==',realMul,imageType)
        realMul = 0
        jsonstr=go.ImagePools.GetOnePool(gameId,imageType,realMul)
        if jsonstr=='' then 
            unilight.info('RRRnorealmul imageType==',realMul,imageType)
            imageType = 1
            jsonstr=go.ImagePools.GetOnePool(gameId,imageType,realMul)
        end
    end
    if imageType == 1 then 
        index1 = index1 + 1
    end 
    if imageType == 2 then 
        index2 = index2 + 1
    end 
    if imageType == 3 then 
        index3 = index3 + 1
    end 
    if realMul > 0 then 
        rmdayu0 = rmdayu0 + 1
        if realMul > 1 then 
            rmdayu1 = rmdayu1 +1 
        end 
    end 

    unilight.info('index1 index2   index3 rmdayu0 rmdayu1 ',index1,index2,index3,rmdayu0,rmdayu1)
    unilight.info('realMul',realMul)
    unilight.info('imageType',imageType)
    unilight.info('jsonstr',jsonstr)
    local jsonobj = json.decode(jsonstr)
    if not demo  then 
        userinfo.gameData.slotsBet = userinfo.gameData.slotsBet + betchip
        if gameId == 137 then 
            userinfo.gameData.slotsWin = userinfo.gameData.slotsWin + math.floor(realMul * betchip)
        else
            userinfo.gameData.slotsWin = userinfo.gameData.slotsWin + math.floor(realMul * betchip*gameObj.LineNum)
        end 
    end 
    return jsonobj,realMul,imageType
end
--取出0倍图库
function getZeroImagePool(gameId)
    local jsonstr=go.ImagePools.GetOnePool(gameId,1,0)
    local jsonobj = json.decode(jsonstr)
    return jsonobj,0
end




function getPlayerMaxMul(userinfo,betchip,totalRechargeChips,gameType,gameObj)
    local chips =chessuserinfodb.GetAHeadTolScore(userinfo._id)
    local condition = 0
    for key, value in pairs(table_autoControl_dc) do
        if totalRechargeChips >= value.chargeLimit and totalRechargeChips <= value.chargeMax then
            condition = key
            break
        end
    end
    if condition <= 0 then
        condition = #table_autoControl_dc
    end
    local mul = table_parameter_parameter[20].Parameter
    local mul1 = 0
    local selfMul = userinfo.point.pointMaxMul or 0
    if mul>mul1 and mul1>0 then
        mul = mul1
    end
    if mul>selfMul and selfMul>0 then
        mul = selfMul
    end
    if userinfo.point.MiddleMul~=nil and userinfo.point.MiddleMul>0 and userinfo.point.MiddleMul<mul then
        mul = userinfo.point.MiddleMul
    end
    --计算玩家最大允许金币值
    --玩家最高上限
    --userinfo.point.chargeMax
    local chargeMaxMul = userinfo.point.chargeMax/betchip
    if mul>chargeMaxMul then
        mul = chargeMaxMul
    end
    userinfo.point.maxMul = mul
end
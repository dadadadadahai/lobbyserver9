module('gameImagePool',package.seeall)
local table_autoControl_dc = import 'table/table_autoControl_dc'
local table_parameter_parameter = import 'table/table_parameter_parameter'
local table_auto_betUp = import 'table/table_auto_betUp'
--图库数据
--[[
    [gameId]={
        [type] = [mul] = info
    }
]]
math.randomseed(tonumber(tostring(os.time()):reverse():sub(1, 9)))
local poolMap={}
function loadPool(gameId)
    go.ImagePools.LoadImagePool(gameId,unilight.get_mongodb())
end

--[[
    gameObj 游戏模块
    param {betchip 押注值
    }
]]
local index1 = 0
local index2 = 0
local index3 = 0
local rmdayu0  = 0
local rmdayu1  = 0
function RealCommonRotate(_id,gameId,gameType,imageType,gameObj,param)
    local betchip = param.betchip
    local demo = param.demo
    local userinfo = unilight.getdata('userinfo',_id)
    local totalRechargeChips = userinfo.property.totalRechargeChips
    userinfo.point.chargeMax = 100000000
    userinfo.point.maxMul = 40000
    local controlvalue = gamecommon.GetControlPoint(_id,param)
    -- --获取rtp
   local rtp = gamecommon.GetModelRtp(_id, gameId, gameType, controlvalue)
   if not demo  then 
        local betIndex = param.betIndex
        local betrtptable = gameObj['table_'..gameId..'_betrtp']
        rtp =  betrtptable[gamecommon.CommRandInt(betrtptable,'bet'..betIndex)].bet_level
        unilight.info('@@@@betrtptablertp', rtp) 
        --local rtptable = gameObj['table_'..gameId..'_rtpswitch']
       -- local rtp = 200 --没充值的直接走200
       -- if totalRechargeChips >0 then 
       --  rtp =  rtptable[gamecommon.CommRandInt(rtptable,'pro')].type
        --end 
   else
        rtp = 200 
   end
    local imagePro = string.format("table_%d_imagePro",gameId)
    if imageType==nil then
        imageType = gameObj[imagePro][gamecommon.CommRandInt(gameObj[imagePro],'gailv'..rtp)].type
        -- local sfree = gameObj.gmInfo.sfree
        -- if sfree>0 then
        --     imageType = sfree
        -- end
    end

    --就计算玩家当前允许的最大倍数 改变了userinfo.point.maxMul的值
    -- getPlayerMaxMul(userinfo,betchip,totalRechargeChips,gameType,gameObj)
    --开始拼装配置表
    local tmpPoolConfig = {}
    local tableconfig = string.format('table_%d_rtp',gameId)
    local mulField =  string.format('type%d_%d',imageType,rtp)
    local gailvFiel = string.format('type%d_gailv%d',imageType,rtp)
    local tableOjconfig = gameObj[tableconfig]
    for _, value in ipairs(tableOjconfig) do
        if value[mulField]<=userinfo.point.maxMul and value[mulField]>=0 then
            table.insert(tmpPoolConfig,{
                mul = value[mulField],
                gailv = value[gailvFiel]
            })
        end
    end
    --执行随机    

    unilight.info('userinfo.point.maxMul',userinfo.point.maxMul,tableconfig,imageType,rtp,mulField,gailvFiel,#tmpPoolConfig)
    local realMul = 0
    if #tmpPoolConfig>0 then
        realMul=tmpPoolConfig[gamecommon.CommRandInt(tmpPoolConfig,'gailv')].mul
    else
        imageType=1
    end
    if gameId == 164    then 
        local curealmul = {100,2,1,5,15,12,8,25,50,0,3,4,10}
        realMul =curealmul[math.random(#curealmul)]
    end 
    if gameId == 163    then 
        if imageType == 1 then 
           local curealmul = {5,5,20,0,0,5,55,5,0,0,0,5,45,0,10,5,0,10,0,0,55,10,0,5,30,10,25,0,0,0,0,0,0,0,0,10,0,15,0,0,0,0,0,45,5,15,0,0,0,20,0,5,15,0,5,0,0,0,10,0,5,5,25,10,0,0,5,15,5,40,10,0,30,0,55,0,0,5,0,40,0,10,0,0,10,25,5,5,0,0,0,0,0,0,0,0,0,0,75,0,5,0,0,15,0,5,10,5,5,0,10,10,0,0,5,0,10,0,15,0,20,0,10,0,0,5,0,0,0,0,0,0,5,10,0,0,0,5,40,0,15,0,40,0,40,40,0,0,5,0,0,0,0,0,10,5,0,10,10,10,0,45,5,0,0,0,5,0,25,0,10,5,0,5,10,0,45,0,0,20,0,0,0,5,10,10,0,15,0,10,0,5,0,0,0,0,50,0,5,15,0,0,0,5,0,0,0,0,0,5,0,0,10,0,0,5,5,5,0,20,0,20,10,10,90,10,0,0,0,5,10,0,0,15,0,10,20,0,5,0,0,5,90,15,0,5,0,15,0,5,0,30,0,0,0,0,10,0,20,0,0,0,0,0,0,10,5,5,0,0,0,0,5,10,0,0,0,10,10,20,0,30,5,0,10,60,0,0,0,0,0,10,0,0,10,0,0,10,15,0,45,0,0,0,40,0,0,10,10,10,0,30,10,5,0,10,0,45,0,0,0,0,10,45,0,5,10,0,0,30,0,5,0,5,0,10,0,20,0,0,20,0,5,35,5,5,0,0,0,5,15,0,0,0,15,0,15,0,10,10,90,0,0,0,0,0,55,5,0,5,0,5,5,0,100,0,0,0,0,15,10,0,0,5,5,0,15,0,15,20,0,5,0,5,10,10,25,0,0,15,0,0,10,5,0,0,0,0,5,50,0,10,25,5,5,0,5,15,20,0,0,0,5,0,10,0,5,0,0,15,5,10,0,0,15,0,10,0,0,0,0,5,0,10,10,45,0,10,5,5,0,10,0,20,0,10,0,70,0,0,5,0,5,0,20,0,0,50,0,0,40,0,0,0,10,0,0,0,0,0,0,15,0,0,75,0,15,0,0,10,0,0,5,10,5,30,5,15,10,5,0,5,0,5,20,5,0,0,0,40,0,5,10,5,10,5,10,0,0,0,0,15,10,0,0,0,10,0,0,0,0,10,0,0,10,0,0,0,5,0,0,5,100,10,0,10,0,0,10,0,10,0,5,0,0,10,0,0,10,5,5,10,15,0,5,0,5,0,10,25,25,0,0,0,5,0,5,0,5,0,0,20,0,15,30,0,10,0,5,20,80,0,0,0,5,0,0,5,0,0,0,30,15,0,20,5,0,15,0,0,25,0,5,10,20,65,10,0,5,5,0,10,15,5,0,20,5,10,0,5,0,0,10,0,10,0,0,15,0,30,0,10,0,0,40,10,0,30,0,0,0,5,20,5,10,0,0,20,0,50,5,0,0,0,0,5,0,0,0,15,0,0,0,0,0,0,0,0,5,10,0,0,0,10,5,0,0,0,0,20,0,0,40,0,0,0,0,0,0,0,5,0,5,10,0,0,5,0,10,0,0,0,0,5,0,15,5,10,25,5,0,5,10,0,5,0,5,5,5,35,0,40,0,0,5,0,10,10,0,0,40,15,0,0,0,0,10,0,0,0,10,0,10,5,5,15,0,80,0,5,0,5,5,10,5,0,0,20,0,10,0,0,5,10,0,0,0,115,0,0,0,0,5,0,0,0,0,0,0,20,10,0,0,10,0,0,10,5,0,0,5,0,50,0,5,0,10,0,15,20,0,0,0,5,10,5,10,0,5,0,45,0,0,50,5,0,30,0,5,0,20,5,145,15,0,5,30,30,5,10,10,15,15,0,0,5,0,50,0,0,40,0,20,5,0,5,40,0,5,5,10,10,0,10,0,10,15,0,0,10,0,0,5,0,0,5,0,0,5,5,0,0,15,45,0,0,0,0,0,35,10,0,10,5,10,40,0,0,15,5,10,5,0,0,0,5,0,10,0,5,10,0,10,0,0,5,20,0,90,0,5,10,15,0,0,20,10,10,0,30,30,0,0,5,0,0,0,0,0,5,10,0,30,0,0,10,10,5,10,0,5,0,5,5,50,0,0,5,0,0,5,0,0,10,10,0,0,0,0,10,15,0,10,0,0,40,10,15,0,0,5,0,5,40,10,0,10,55,5,0,5,0,0,5,5,10,0,10,5,0}
            realMul =curealmul[math.random(#curealmul)]
        end 
        if imageType == 2 then 
            local curealmul = {15,270,20,15,140,65,45,20,220,40,55,70,160,65,10,40,50,40,25,20,220,70,220,20,35,50,45,70,30,150,375,15,90,225,50,1070,20,205,130,630,30,40,0,50,185,200,1720,55,210,15,35,40,60,180,190,65,175,185,190,75,30,180,505,175,75,15,55,60,80,55,50,40,250,170,555,385,355,20,25,60,210,40,220,55,20,620,165,45,225,45,100,15,255,85,180,50,110,100,70,25,235,65,180,30,20,15,40,105,35,60,105,25,65,185,5,90,55,25,740,30,70,85,30,35,20,40,75,195,20,115,30,20,10,65,200,390,45,70,15,250,85,40,90,25,35,195,475,175,325,170,20,200,65,170,290,45,485,65,360,460,220,195,680,205,40,50,170,65,210,15,50,20,215,40,105,100,55,70,175,200,20,80,1545,15,10,30,10,55,70,85,0,25,230,195,635,185,40,170,50,60,160,125,35,185,30,210,40,120,185,55,210,25,90,55,150,225,55,45,0,55,25,170,50,570,105,25,40,20,30,525,55,515,55,255,220,25,190,30,30,110,10,225,130,45,20,25,55,5,35,185,195,70,25,50,10,25,15,215,105,475,745,155,45,55,75,475,160,225,215,170,560,20,620,205,55,25,15,25,85,45,45,185,15,355,65,40,220,335,5,15,165,170,310,185,40,55,195,180,40,180,40,180,160,20,30,20,75,200,180,30,10,325,80,5,185,30,30,30,30,25,35,25,20,35,20,20,460,30,30,20,70,10,340,470,35,30,120,115,75,0,25,140,150,305,160,80,210,165,80,320,205,10,130,10,165,210,35,30,495,55,20,160,40,20,30,170,145,215,205,175,490,190,60,15,135,25,35,60,80,105,30,55,250,15,10,0,30,80,470,60,40,470,40,75,50,205,15,25,205,25,15,350,20,280,40,60,45,55,5,55,175,30,240,280,25,35,210,170,495,105,35,85,55,35,30,155,170,85,30,70,645,25,20,65,35,25,35,645,25,40,30,20,20,505,110,180,125,350,30,20,365,15,470,20,30,60,10,195,465,20,25,15,40,220,190,170,40,60,205,855,30,480,5,130,30,160,555,70,25,170,220,505,135,70,70,500,40,45,315,35,10,480,55,205,30,180,70,555,50,490,30,500,235,15,30,490,45,75,75,75,115,405,90,20,15,40,520,165,275,555,105,35,420,165,25,45,10,85,75,320,190,55,10,200,25,475,125,205,45,490,205,80,20,30,155,45,115,35,165,200,180,635,465,90,55,90,15,205,70,190,30,0,660,30,20,390,100,20,480,30,555,0,165,90,80,180,105,175,40,20,10,35,185,5,160,20,20,185,20,455,40,40,70,10,25,155,85,45,195,70,125,535,60,340,220,45,1125,215,215,280,45,25,225,15,25,225,15,25,25,15,25,315,615,160,390,340,60,165,30,385,470,235,55,25,35,175,85,45,40,10,45,35,0,485,65,75,20,320,45,35,35,490,80,240,480,45,115,50,195,90,35,35,20,25,175,45,40,35,25,35,40,375,10,20,175,385,65,215,220,180,10,205,145,60,320,75,20,475,65,10,330,20,195,35,55,40,15,10,40,195,670,25,220,25,205,210,210,15,355,230,35,235,60,70,30,30,165,210,350,220,315,215,475,50,30,60,1990,25,125,170,5,195,185,510,55,75,40,60,160,20,85,495,35,155,115,10,55,200,15,15,615,25,80,170,500,25,110,25,990,25,370,50,85,15,200,290,35,190,40,90,240,190,165,15,165,70,105,55,20,50,305,620,20,180,210,25,220,40,85,45,10,40,175,40,35,35,195,30,35,80,190,195,30,355,40,395,500,285,40,65,40,45,90,65,40,190,80,185,165,175,25,20,120,240,35,50,165,185,30,80,175,45,80,30,10,530,160,40,505,110,35,20,40,185,120,35,15,20,190,65,380,240,355,15,630,80,40,75,30,25,175,35,670,175,200,35,55,70,180,5,60,70,40,195,460,205,15,100,95,105,180,40,195,315,905,40,0,1345,25,170,205,135,40,75,50,25,165,40,125,60,70,70,45,35,470,175,20,660,160,45,95,230,60,110,15,315,95,305,205,55,15,10,35,235,15,60,45,40,155,15,15,170,20,45,15,5,50,40,195,20,40,220,165,40,170,265,15,20,310,160,20,105,115,65,615,30,460,80,170,50,205,20,185,75,105,170,15,45,40,40,85,85,250,35,175,495,45,510,200,30,50,165,180,180,315,35,355,30,45,30,15,120,15,540,160,40,45,30,35,5}
             realMul =curealmul[math.random(#curealmul)]
        end 
        if imageType == 3 then 
           local curealmul = {1500,450,450,170,150,175,160,455,165,150,150,150,175,155,165,150,150,150,160,150,150,150,150,155,450,150,460,150,155,150,150,150,155,150,160,150,150,450,450,150,155,150,185,150,150,460,150,1505,160,1500,150,450,150,150,190,155,160,450,155,450,150,450,150,150,150,155,1510,150,150,155,150,155,150,150,150,160,170,165,150,150,160,170,150,190,150,150,150,150,150,150,490,150,450,150,195,160,150,450,150,160,450,1500,150,460,155,155,460,160,150,155,450,150,150,150,165,165,450,170,150,155,150,150,450,150,155,155,150,170,165,150,165,160,150,150,150,450,155,150,455,455,150,150,150,160,455,150,150,150,150,150,150,150,160,150,150,160,150,150,460,150,150,150,150,470,150,150,150,165,150,150,150,165,450,455,460,450,150,150,160,160,460,150,150,160,160,460,155,165,180,150,150,450,155,150,1500,170,150,150,150,450,150,450,150,150,150,460,155,150,150,175,150,455,455,150,150,150,150,170,450,150,450,455,150,150,155,460,155,190,160,460,195,470,150,155,150,455,150,175,150,160,150,165,150,150,150,150,150,160,155,155,465,150,450,360,160,155,160,155,150,160,150,450,155,150,155,155,155,170,150,150,150,155,150,465,155,160,150,150,150,160,150,150,170,150,150,150,170,150,160,155,150,150,150,460,450,460,150,150,160,450,175,150,455,150,150,165,150,455,165,150,150,150,150,155,470,150,450,160,155,160,150,175,150,150,150,455,150,455,160,150,150,450,150,175,450,200,155,150,150,450,450,150,150,150,150,160,155,455,150,155,150,150,450,150,460,150,470,150,150,150,150,160,150,150,150,150,450,160,150,150,450,150,165,150,155,450,180,150,150,460,150,150,455,150,150,150,150,150,155,160,150,450,155,150,160,150,450,150,150,150,160,150,150,155,190,155,160,165,450,155,150,200,150,150,150,150,450,150,160,160,450,155,150,150,450,150,150,150,150,450,450,160,160,160,450,150,150,155,150,160,150,150,150,465,150,150,160,150,150,170,150,450,165,155,450,160,150,150,150,150,150,155,455,155,150,150,160,150,150,455,150,155,150,175,450,150,1505,150,155,150,155,470,450,450,155,150,175,160,150,450,190,460,150,450,450,155,150,150,460,450,155,160,165,160,150,150,450,455,500,150,455,150,155,190,150,150,450,150,160,155,160,150,150,150,150,150,150,455,155,150,150,150,150,150,210,150,150,450,450,155,160,450,150,190,450,150,150,160,150,230,150,450,450,150,175,460,150,150,455,150,155,150,150,150,160,1525,1500,150,150,150,165,150,150,150,150,150,150,150,150,450,150,160,155,150,450,150,150,160,455,450,160,150,150,150,155,150,150,150,150,190,160,150,150,150,150,155,450,150,155,150,150,150,150,150,450,150,150,150,150,150,150,150,450,150,150,160,450,460,150,155,160,160,465,160,150,450,450,150,155,155,165,160,150,450,150,450,450,160,160,155,150,150,150,165,150,150,150,150,150,160,450,150,150,190,150,160,1515,150,150,150,465,150,150,155,450,150,150,150,450,150,150,455,150,465,165,150,165,155,160,150,450,450,150,465,155,150,150,160,150,1515,150,155,150,155,450,150,150,150,150,150,150,155,190,150,150,170,470,150,155,150,150,150,150,155,160,155,155,150,150,150,150,150,150,150,160,455,155,155,190,150,465,150,150,455,150,150,155,150,150,150,170,150,150,150,155,190,150,150,455,160,150,160,150,150,155,150,165,465,155,150,170,450,150,150,150,160,150,150,155,150,170,150,150,150,150,150,150,150,150,150,220,190,155,150,450,450,155,150,160,150,150,160,160,150,165,450,155,450,150,150,170,450,150,155,150,150,150,450,455,155,165,155,150,450,160,160,450,150,450,465,150,150,150,150,155,150,150,150,150,150,450,150,150,455,155,455,155,450,150,170,170,465,150,150,150,150,195,150,450,450,460,170,150,465,170,150,150,155,150,150,150,175,155,450,150,460,450,450,450,150,155,150,150,150,190,150,150,150,150,455,150,150,150,150,150,150,155,150,170,150,150,150,160,160,150,150,155,155,150,160,150,150,170,460,155,150,155,150,150,150,450,150,160,150,160,155,155,155,150,150,150,450,165,150,150,150,460,150,165,150,150,455,150,150,155,150,450,175,150,150,450,460,150,205,450,150,160,160,160,150,450,155,175,160,155,160,160,150,150,450,150,450,150,150,150,150,190,450,150,150,150,165,150,150,460,160,150,155,455,165,150,460,150,150,150,450,150,450,150,455}
            realMul =curealmul[math.random(#curealmul)]
        end 
    end
    if gameId == 126    then 
        local curealmul = {0,0,0,0.2,0,0.2,0,0.6,0.2,0,0,0,0.2,0.4,0,0.7,0,0.2,0,0,0.2,1,0,0.2,0,0,0,0.4,0,0.2,0,0,0,0,0.2,0,0.4,0.6,0.4,0,1,0,0,0,0,0,0,10.2,2,0.2,0.2,0,0,0.4,0,0,0,0,0.2,0,0.2,0,0,0,0,0,5.2,0.2,1,0,3,0,0,0,0,0,0.2,0,0.2,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0.2,0,0,0.2,0,0,0.2,0,0,0.2,0,0,0,0,0.2,3.2,0,0,0.2,0,0,0,0,0,3,0,0,1.2,0,0,0.2,0.2,0.6,0,0,0,0,1.2,0.2,0,0,0,0.2,0,0,0,0,0.2,0,0,5.5,0,0.4,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0.2,0.4,0,0,0,0.4,0,0,0,0,0,0,0,0,0,0,0,0,0.4,0.2,0,0,0.4,0,0.2,0,0,0,0.2,0,0.2,0,0,0,0,0,0,0,0,0,0,0.5,0,0.2,0,1.4,0,0,1.2,0.2,0,0,0,0,0.2,0.2,0.7,0,0,0.2,0,0,0,0,0.2,0,0,0,3,0,0,0,0,0,2,0,0,0.4,0.2,0,0.2,0.2,0,0,0,0,0,2.7,0,0,0,0,1,0,0.2,0,0,0.2,0,0,0,2,0,0,1,0,0.5,0,0,0,0,0,2,0.2,0,0,0,0.4,0,0,0,0,0,0.2,0,0,0.2,0.2,1,0.4,0,0,0,0.2,0,0,1,0,0,0,0.5,3,0.2,0,0.2,0,0,0,0,0.2,0,0,0,0,0,0.2,0.2,0,0.2,0.2,0,0.4,0,0,0,1,0.2,0,0,0.2,0,0,0,0,0,0,0,0.5,1,0,0.4,0.4,1,0,0,0.2,1,0,0,0,0.2,0,0,0,0,0,0,1.2,0.2,2,0,0,0,0.2,0.2,0,0.5,0,0.2,0,0,0.2,0,0,0.2,0,1,0.2,0,0,0,0,0,0,0,5.2,0,0,0,0,0,5,0,0,0.2,0.4,0,0,0,0,0,0,0.2,0,5,0.2,0,1,0,0,0,0,0.2,0.2,0.2,0,0,0,0,0,0.2,0,0,0,2,0,0,0.4,0,0,0,0,2,0,0,0,0,2,0.2,0,0,0,0.2,0.6,0,0,0,0,0,6.2,1,0,0,0.6,0,0.2,0,0,0.2,0.2,0,0.2,0,0,0,0,0,0.2,0,0,0.2,0,0.2,0,0,0,12.6,0,0,6,0.7,0,0.2,0,0,0,0,0,0.4,0,0,0,0,0,0,0.2,0,0,0,0.4,0,0,1.6,0,0,0,0,0,2,0,0.2,0,1,0.2,0.4,0,0,0,0,1.2,0,0,0.4,0,0.2,0,0.4,0,2.2,0.2,0,0,0,0,0.5,0,0,20,0.2,0,0,0,0,0,0,0,0.4,0,0.2,0,0,1,2.5,0,0,0,0,0,0,0,0,0,0,0,0,1.2,0,0,0,0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0.2,0,0,0,0,0,0,0,0,0,0,0,0.2,0.7,0.2,0.4,0,0,0,0.2,0,0.2,0,0.2,0,0,0,0.2,0.4,0,1,0,0,0.2,0,0,0,0.2,0.2,0,0,0,0,1.2,0,0,5.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0,0.2,0,0,0,0,0.2,0,0,0,0,0.6,0.2,0,2.2,0,0,0,0,0,0,0,0,0.2,0.2,0.2,0.2,0,0.2,0,0.2,0,0,0,0,0.2,0.4,0.2,2,0,0.2,1.2,0,0,0,0,0,0,0,0,0,0.4,0,6,0,0,0,0,0,0,0,0,0,0.2,5.7,0,0.2,0,0,0,0,0,0,0,0,0,0,0,5,0,0,1,0,0,0,0.2,0.2,0,1,0.2,0,0.2,0,0,0,6,0,0.2,0,0,0,0.2,2.5,0,0,2,0,0,0.2,0,0,0,0,0,0,0,0.2,0,0,0.2,0,0.2,0,0,0.2,0,0,0.2,0,0,1,0.4,0,0,0.6,0.2,0,0,0,0.2,0,0.2,0.4,0,0.4,0,5,0,0,10,1.2,0.2,1,0.2,0.2,0,0.7,0.2,0,0,0.2,0,0.2,0.2,0,0,0,0,0.4,1.2,10,1,0,0.9,0,0,0.2,0.2,0.4,0,0,0,0,0.2,0,0,0,0,0,0,0,0,0.6,0,0,0,0,0,0,0.2,0,0,0.4,0,0.2,0.2,1,0,0,0.2,0,0,0,0.2,0,0,0.6,0,0.2,0.2,0.2,0,0.6,0,0.2,0,0.4,0,0.5,0,0,0,0,0,0.2,0,0.2,0.2,0,0.4,0.4,0,0,0.2,0,0,0,0,0,0,0,1,0.2,0,0.2,0,0,0,1,0.2,0,0.2,0,0,0,0,0,1.4,0,0.2,0,0,0.2,0,0,1,0,0,0,0,0.2,0.2,0,0,0.2,0,0.2,0,0,0,0,0.2,0.2,0,0,0,0,0,0,0,0,0,0,0.2,0,0,0.4,0,0.4,0,0,0,0.2,0.2,0,0.2,0,0,0,0,0,0,0}
        realMul =curealmul[math.random(#curealmul)]
    end 
    unilight.info('gameId.imageType.realMul',gameId,imageType,realMul)
    

    local jsonstr=go.ImagePools.GetOnePool(gameId,imageType,realMul)
    if jsonstr=='' then
        unilight.info('norealmul imageType==',realMul,imageType)
        realMul = 0
        jsonstr=go.ImagePools.GetOnePool(gameId,imageType,realMul)
        if jsonstr=='' then 
            unilight.info('RRRnorealmul imageType==',realMul,imageType)
            imageType = 1
            jsonstr=go.ImagePools.GetOnePool(gameId,imageType,realMul)
        end
    end
    if imageType == 1 then 
        index1 = index1 + 1
    end 
    if imageType == 2 then 
        index2 = index2 + 1
    end 
    if imageType == 3 then 
        index3 = index3 + 1
    end 
    if realMul > 0 then 
        rmdayu0 = rmdayu0 + 1
        if realMul > 1 then 
            rmdayu1 = rmdayu1 +1 
        end 
    end 

    unilight.info('index1 index2   index3 rmdayu0 rmdayu1 ',index1,index2,index3,rmdayu0,rmdayu1)
    unilight.info('realMul',realMul)
    unilight.info('imageType',imageType)
    unilight.info('jsonstr',jsonstr)
    local jsonobj = json.decode(jsonstr)
    if not demo  then 
        userinfo.gameData.slotsBet = userinfo.gameData.slotsBet + betchip
        if gameId == 137 then 
            userinfo.gameData.slotsWin = userinfo.gameData.slotsWin + math.floor(realMul * betchip)
        else
            userinfo.gameData.slotsWin = userinfo.gameData.slotsWin + math.floor(realMul * betchip*gameObj.LineNum)
        end 
    end 
    return jsonobj,realMul,imageType
end
--取出0倍图库
function getZeroImagePool(gameId)
    local jsonstr=go.ImagePools.GetOnePool(gameId,1,0)
    local jsonobj = json.decode(jsonstr)
    return jsonobj,0
end




function getPlayerMaxMul(userinfo,betchip,totalRechargeChips,gameType,gameObj)
    local chips =chessuserinfodb.GetAHeadTolScore(userinfo._id)
    local condition = 0
    for key, value in pairs(table_autoControl_dc) do
        if totalRechargeChips >= value.chargeLimit and totalRechargeChips <= value.chargeMax then
            condition = key
            break
        end
    end
    if condition <= 0 then
        condition = #table_autoControl_dc
    end
    local mul = table_parameter_parameter[20].Parameter
    local mul1 = 0
    local selfMul = userinfo.point.pointMaxMul or 0
    if mul>mul1 and mul1>0 then
        mul = mul1
    end
    if mul>selfMul and selfMul>0 then
        mul = selfMul
    end
    if userinfo.point.MiddleMul~=nil and userinfo.point.MiddleMul>0 and userinfo.point.MiddleMul<mul then
        mul = userinfo.point.MiddleMul
    end
    --计算玩家最大允许金币值
    --玩家最高上限
    --userinfo.point.chargeMax
    local chargeMaxMul = userinfo.point.chargeMax/betchip
    if mul>chargeMaxMul then
        mul = chargeMaxMul
    end
    userinfo.point.maxMul = mul
end